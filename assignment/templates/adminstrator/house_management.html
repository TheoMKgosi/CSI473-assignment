{% extends 'adminstrator/base.html' %}
{% block title %}House Management{% endblock %}

{% block content %}

    <div class="page-header">
        <h1>House Management</h1>
        <p>Overview of all properties and their management status</p>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number">{{ total_houses }}</div>
            <div class="stat-label">Total Properties</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ occupied_houses }}</div>
            <div class="stat-label">Occupied</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ vacant_houses }}</div>
            <div class="stat-label">Vacant</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ occupancy_rate }}%</div>
            <div class="stat-label">Occupancy Rate</div>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3>Property Type Distribution</h3>
        </div>
        <div class="card-body">
            <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                {% for property_type, count in property_types.items %}
                    <div style="text-align: center;">
                        <div style="width: 80px; height: 80px; background: #007bff; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 1.2em;">
                            {{ count }}
                        </div>
                        <div style="margin-top: 10px; font-weight: 500;">{{ property_type|title }}</div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3>Property Details</h3>
        </div>
        <div class="card-body">
            {% if houses %}
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Details</th>
                                <th>Owner</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for house in houses %}
                                <tr>
                                    <td>
                                        <strong>{{ house.house_number }}</strong><br>
                                        <small style="color: #666;">{{ house.address }}</small>
                                    </td>
                                    <td>
                                        <span style="background: #e9ecef; padding: 3px 8px; border-radius: 12px; font-size: 0.8em; color: #495057;">{{ house.get_property_type_display }}</span><br>
                                        <small>{{ house.bedrooms }} bed, {{ house.bathrooms }} bath, {{ house.square_footage }} sq ft</small>
                                    </td>
                                    <td>{{ house.owner.get_full_name|default:house.owner.username }}</td>
                                    <td>
                                        {% if house.is_occupied %}
                                            <span class="badge" style="background: #d4edda; color: #155724;">Occupied</span>
                                        {% else %}
                                            <span class="badge" style="background: #f8d7da; color: #721c24;">Vacant</span>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <p style="color: #666; font-style: italic;">No properties found in the system.</p>
            {% endif %}
        </div>
    </div>
{% endblock %}