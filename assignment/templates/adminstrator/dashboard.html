{% extends "adminstrator/base.html" %}

{% block title %}Administrator Dashboard{% endblock %}

{% block content %}
        <h1>Administrator Dashboard</h1>
        <div class="welcome">
            <h2>Welcome, {{ user.get_full_name|default:user.username }}!</h2>
            <p>You are logged in as an administrator.</p>
        </div>

    <div class="stats">
        <div class="stat-box">
            <div class="stat-number">{{ pending_security_count }}</div>
            <div>Pending Security</div>
        </div>
        <div class="stat-box">
            <div class="stat-number">{{ pending_members_count }}</div>
            <div>Pending Members</div>
        </div>
        <div class="stat-box">
            <div class="stat-number">{{ approved_security_count }}</div>
            <div>Approved Security</div>
        </div>
        <div class="stat-box">
            <div class="stat-number">{{ approved_members_count }}</div>
            <div>Approved Members</div>
        </div>
        <div class="stat-box">
            <div class="stat-number">{{ rejected_security_count }}</div>
            <div>Rejected Security</div>
        </div>
        <div class="stat-box">
            <div class="stat-number">{{ rejected_members_count }}</div>
            <div>Rejected Members</div>
        </div>
    </div>

    <div class="section">
        <h3>Pending Security Guard Applications</h3>
        {% if pending_security %}
            <div class="security-list">
                {% for security in pending_security %}
                    <div class="security-item pending">
                        <h4>{{ security.user.get_full_name|default:security.user.username }}</h4>
                        <p><strong>Username:</strong> {{ security.user.username }}</p>
                        <!-- <p><strong>Email:</strong>{{ security.email }}</p> -->
                        <p><strong>Employee ID:</strong> {{ security.employee_id }}</p>
                        <p><strong>Phone:</strong> {{ security.phone_number|default:'Not provided' }}</p>
                        <p><strong>Address:</strong> {{ security.address|default:'Not provided' }}</p>
                        <div class="action-buttons">
                            <a href="{% url 'adminstrator:approve_security' security.id %}" class="btn btn-approve">Approve</a>
                            <a href="{% url 'adminstrator:reject_security' security.id %}" class="btn btn-reject">Reject</a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No pending security applications.</p>
        {% endif %}
    </div>

    <div class="section">
        <h3>Pending Member Applications</h3>
        {% if pending_members %}
            <div class="security-list">
                {% for member in pending_members %}
                    <div class="security-item pending">
                        <h4>{{ member.user.get_full_name|default:member.user.username }}</h4>
                        <p><strong>Username:</strong> {{ member.user.username }}</p>
                        <p><strong>Email:</strong> {{ member.user.email }}</p>
                        <p><strong>Phone:</strong> {{ member.phone_number|default:'Not provided' }}</p>
                        <p><strong>Address:</strong> {{ member.address|default:'Not provided' }}</p>
                        <div class="action-buttons">
                            <a href="{% url 'adminstrator:approve_member' member.id %}" class="btn btn-approve">Approve</a>
                            <a href="{% url 'adminstrator:reject_member' member.id %}" class="btn btn-reject">Reject</a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No pending member applications.</p>
        {% endif %}
    </div>

    <div class="section">
        <h3>Approved Members</h3>
        {% if approved_members %}
            <div class="security-list">
                {% for member in approved_members %}
                    <div class="security-item approved">
                        <h4>{{ member.user.get_full_name|default:member.user.username }}</h4>
                        <p><strong>Username:</strong> {{ member.user.username }}</p>
                        <p><strong>Email:</strong> {{ member.user.email }}</p>
                        <p><strong>Phone:</strong> {{ member.phone|default:'Not provided' }}</p>
                        <p><strong>Address:</strong> {{ member.address|default:'Not provided' }}</p>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No approved members.</p>
        {% endif %}
    </div>

    <div class="section">
        <h3>Approved Security Guards</h3>
        {% if approved_security %}
            <div class="security-list">
                {% for security in approved_security %}
                    <div class="security-item approved">
                        <h4>{{ security.user.get_full_name|default:security.user.username }}</h4>
                        <p><strong>Username:</strong> {{ security.user.username }}</p>
                        <p><strong>Email:</strong> {{ security.user.email }}</p>
                        <p><strong>Employee ID:</strong> {{ security.employee_id }}</p>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No approved security guards.</p>
        {% endif %}
    </div>

    <div class="section">
        <h3>Rejected Applications</h3>
        {% if rejected_security or rejected_members %}
            <div class="security-list">
                {% for security in rejected_security %}
                    <div class="security-item rejected">
                        <h4>{{ security.user.get_full_name|default:security.user.username }} (Security)</h4>
                        <p><strong>Username:</strong> {{ security.user.username }}</p>
                        <p><strong>Email:</strong> {{ security.user.email }}</p>
                        <p><strong>Employee ID:</strong> {{ security.employee_id }}</p>
                    </div>
                {% endfor %}
                {% for member in rejected_members %}
                    <div class="security-item rejected">
                        <h4>{{ member.user.get_full_name|default:member.user.username }} (Member)</h4>
                        <p><strong>Username:</strong> {{ member.user.username }}</p>
                        <p><strong>Email:</strong> {{ member.user.email }}</p>
                        <p><strong>Phone:</strong> {{ member.phone|default:'Not provided' }}</p>
                        <p><strong>Address:</strong> {{ member.address|default:'Not provided' }}</p>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No rejected applications.</p>
        {% endif %}
    </div>

    <div>
        <h3>Your Profile Information:</h3>
        <p><strong>Username:</strong> {{ user.username }}</p>
        <p><strong>Email:</strong> {{ user.email }}</p>
        <p><strong>Full Name:</strong> {{ user.get_full_name }}</p>
        {% if user.administrator_profile.employee_id %}
            <p><strong>Employee ID:</strong> {{ user.administrator_profile.employee_id }}</p>
        {% endif %}
        {% if user.administrator_profile.department %}
            <p><strong>Department:</strong> {{ user.administrator_profile.department }}</p>
        {% endif %}
        {% if user.administrator_profile.phone_number %}
            <p><strong>Phone:</strong> {{ user.administrator_profile.phone_number }}</p>
        {% endif %}
    </div>

{% endblock %}