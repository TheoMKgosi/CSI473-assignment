{% extends 'adminstrator/base.html' %}
{% block title %}Administrator Dashboard{% endblock %}

{% block content %}
    <div class="page-header">
        <h1>Administrator Dashboard</h1>
        <p>Welcome, {{ user.get_full_name|default:user.username }}! You are logged in as an administrator.</p>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number">{{ pending_security_count }}</div>
            <div class="stat-label">Pending Security</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ pending_members_count }}</div>
            <div class="stat-label">Pending Members</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ approved_security_count }}</div>
            <div class="stat-label">Approved Security</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ approved_members_count }}</div>
            <div class="stat-label">Approved Members</div>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3>Quick Actions</h3>
        </div>
        <div class="card-body">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                <a href="{% url 'adminstrator:user_management' %}" class="btn btn-primary" style="text-align: center; padding: 15px;">
                    üë• Manage Users
                </a>
                <a href="{% url 'adminstrator:house_management' %}" class="btn btn-success" style="text-align: center; padding: 15px;">
                    üè† Manage Houses
                </a>
                <a href="{% url 'adminstrator:security_compliance' %}" class="btn btn-warning" style="text-align: center; padding: 15px;">
                    üõ°Ô∏è View Patrol Reports
                </a>
                <a href="{% url 'adminstrator:subscription_statistics' %}" class="btn btn-info" style="text-align: center; padding: 15px;">
                    üí∞ View Finance
                </a>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3>Pending Security Guard Applications</h3>
        </div>
        <div class="card-body">
            {% if pending_security %}
                <div style="display: grid; gap: 15px;">
                    {% for security in pending_security %}
                        <div style="border: 1px solid #dee2e6; border-radius: 5px; padding: 15px; border-left: 4px solid #ffc107;">
                            <h4 style="margin: 0 0 10px 0; color: #333;">{{ security.user.get_full_name|default:security.user.username }}</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-bottom: 15px;">
                                <div><strong>Username:</strong> {{ security.user.username }}</div>
                                <div><strong>Email:</strong> {{ security.user.email }}</div>
                                <div><strong>Employee ID:</strong> {{ security.employee_id }}</div>
                                <div><strong>Phone:</strong> {{ security.phone_number|default:'Not provided' }}</div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <a href="{% url 'adminstrator:approve_security' security.id %}" class="btn btn-success">Approve</a>
                                <a href="{% url 'adminstrator:reject_security' security.id %}" class="btn btn-danger">Reject</a>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p style="color: #666; font-style: italic;">No pending security applications.</p>
            {% endif %}
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3>Pending Member Applications</h3>
        </div>
        <div class="card-body">
            {% if pending_members %}
                <div style="display: grid; gap: 15px;">
                    {% for member in pending_members %}
                        <div style="border: 1px solid #dee2e6; border-radius: 5px; padding: 15px; border-left: 4px solid #ffc107;">
                            <h4 style="margin: 0 0 10px 0; color: #333;">{{ member.user.get_full_name|default:member.user.username }}</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-bottom: 15px;">
                                <div><strong>Username:</strong> {{ member.user.username }}</div>
                                <div><strong>Email:</strong> {{ member.user.email }}</div>
                                <div><strong>Phone:</strong> {{ member.phone_number|default:'Not provided' }}</div>
                                <div><strong>Address:</strong> {{ member.address|default:'Not provided' }}</div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <a href="{% url 'adminstrator:approve_member' member.id %}" class="btn btn-success">Approve</a>
                                <a href="{% url 'adminstrator:reject_member' member.id %}" class="btn btn-danger">Reject</a>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p style="color: #666; font-style: italic;">No pending member applications.</p>
            {% endif %}
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3>Approved Security Guards</h3>
        </div>
        <div class="card-body">
            {% if approved_security %}
                <div style="display: grid; gap: 10px;">
                    {% for security in approved_security %}
                        <div style="border: 1px solid #dee2e6; border-radius: 5px; padding: 12px; border-left: 4px solid #28a745; background: #f8f9fa;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <strong>{{ security.user.get_full_name|default:security.user.username }}</strong>
                                    <span style="color: #666; margin-left: 10px;">{{ security.user.username }} ‚Ä¢ ID: {{ security.employee_id }}</span>
                                </div>
                                <span class="badge badge-active">Approved</span>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p style="color: #666; font-style: italic;">No approved security guards.</p>
            {% endif %}
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3>Rejected Applications</h3>
        </div>
        <div class="card-body">
            {% if rejected_security %}
                <div style="display: grid; gap: 10px;">
                    {% for security in rejected_security %}
                        <div style="border: 1px solid #dee2e6; border-radius: 5px; padding: 12px; border-left: 4px solid #dc3545; background: #f8f9fa;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <strong>{{ security.user.get_full_name|default:security.user.username }}</strong>
                                    <span style="color: #666; margin-left: 10px;">{{ security.user.username }} ‚Ä¢ ID: {{ security.employee_id }}</span>
                                </div>
                                <span class="badge badge-inactive">Rejected</span>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p style="color: #666; font-style: italic;">No rejected applications.</p>
            {% endif %}
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3>Your Profile Information</h3>
        </div>
        <div class="card-body">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                <div><strong>Username:</strong> {{ user.username }}</div>
                <div><strong>Email:</strong> {{ user.email }}</div>
                <div><strong>Full Name:</strong> {{ user.get_full_name }}</div>
                {% if user.administrator_profile.employee_id %}
                    <div><strong>Employee ID:</strong> {{ user.administrator_profile.employee_id }}</div>
                {% endif %}
                {% if user.administrator_profile.department %}
                    <div><strong>Department:</strong> {{ user.administrator_profile.department }}</div>
                {% endif %}
                {% if user.administrator_profile.phone_number %}
                    <div><strong>Phone:</strong> {{ user.administrator_profile.phone_number }}</div>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}
